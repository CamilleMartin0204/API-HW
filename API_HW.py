#!/usr/bin/env python
# coding: utf-8

# In[ ]:


# Dependencies and Setup
import matplotlib.pyplot as plt
import pandas as pd
import numpy as np
import requests
import time

# Import API key
from api_keys import api_key

# Incorporated citipy to determine city based on latitude and longitude
from citipy import citipy

# Output File (CSV)
output_data_file = "output_data/cities.csv"

# Range of latitudes and longitudes
lat_range = (-90, 90)
lng_range = (-180, 180)


# In[ ]:


api_key


# In[ ]:


'6b810bc42fef396c8ca3a8021f2e2697'


# In[ ]:


# List for holding lat_lngs and cities
lat_lngs = []
cities = []

# Create a set of random lat and lng combinations
lats = np.random.uniform(low=-90.000, high=90.000, size=1500)
lngs = np.random.uniform(low=-180.000, high=180.000, size=1500)
lat_lngs = zip(lats, lngs)

# Identify nearest city for each lat, lng combination
for lat_lng in lat_lngs:
    city = citipy.nearest_city(lat_lng[0], lat_lng[1]).city_name
    
    # If the city is unique, then add it to a our cities list
    if city not in cities:
        cities.append(city)

# Print the city count to confirm sufficient count
len(cities)


# In[ ]:


601


# In[ ]:


cities


# In[ ]:


['ilulissat',
 'komsomolskiy',
 'kang',
 'barrow',
 'upernavik',
 'tiksi',
 'arraial do cabo',
 'hilo',
 'truro',
 'khatanga',
 'norman wells',
 'elbrus',
 'ponta do sol',
 'rikitea',
 'banjarmasin',
 'ushuaia',
 'yaan',
 'gornyy',
 'hermanus',
 'mar del plata',
 'codrington',
 'port alfred',
 'den helder',
 'atuona',
 'sistranda',
 'amderma',
 'nizhniy odes',
 'tura',
 'seoul',
 'lasa',
 'torbay',
 'dedovichi',
 'vaitupu',
 'port blair',
 'bluff',
 'mayya',
 'alugan',
 'saint-augustin',
 'cape town',
 'boa vista',
 'kruisfontein',
 'flin flon',
 'lagoa',
 'goba',
 'yarada',
 'mys shmidta',
 'marcona',
 'padang',
 'thompson',
 'sechura',
 'mataura',
 'muncar',
 'saldanha',
 'kahului',
 'illoqqortoormiut',
 'busselton',
 'botou',
 'bredasdorp',
 'misawa',
 'port lincoln',
 'karaul',
 'clyde river',
 'gat',
 'mahebourg',
 'vila velha',
 'general roca',
 'san quintin',
 'los llanos de aridane',
 'dikson',
 'chokurdakh',
 'esperance',
 'kodiak',
 'brae',
 'pereslavl-zalesskiy',
 'hobyo',
 'bandarbeyla',
 'taolanaro',
 'sitka',
 'xuddur',
 'takoradi',
 'rawannawi',
 'punta arenas',
 'fort nelson',
 'hobart',
 'kharitonovo',
 'lebu',
 'puerto ayora',
 'ahipara',
 'quelimane',
 'tigil',
 'tooele',
 'isangel',
 'barentsburg',
 'bengkulu',
 'alice springs',
 'las vegas',
 'tavda',
 'bocas del toro',
 'mersing',
 'jamestown',
 'san cristobal',
 'gamba',
 'macomb',
 'oktyabrskiy',
 'necochea',
 'chuy',
 'ribeira grande',
 'dunedin',
 'muros',
 'victoria',
 'butaritari',
 'attawapiskat',
 'chagda',
 'nikolskoye',
 'aswan',
 'coquimbo',
 'galiwinku',
 'padilla',
 'albany',
 'avarua',
 'waihi beach',
 'hithadhoo',
 'ashland',
 'kapaa',
 'cayenne',
 'sosnogorsk',
 'san luis',
 'celestun',
 'lanigan',
 'qaanaaq',
 'piacabucu',
 'coihaique',
 'salvador',
 'kuche',
 'ambodifototra',
 'zabaykalsk',
 'sao miguel do araguaia',
 'genova',
 'svetlogorsk',
 'comodoro rivadavia',
 'lolua',
 'namatanai',
 'winneba',
 'san patricio',
 'bowen',
 'sentyabrskiy',
 'port elizabeth',
 'longyearbyen',
 'vaini',
 'tasiilaq',
 'kodinsk',
 'yellowknife',
 'carnarvon',
 'tairua',
 'hamza',
 'lorengau',
 'samusu',
 'scarborough',
 'gaomi',
 'haines junction',
 'olafsvik',
 'hasaki',
 'bambous virieux',
 'quatre cocos',
 'beitbridge',
 'dargaville',
 'husavik',
 'jacareacanga',
 'ostrovnoy',
 'agva',
 'tuktoyaktuk',
 'dukat',
 'katsuura',
 'beloomut',
 'mtinko',
 'ijaki',
 'homer',
 'valdivia',
 'omboue',
 'dinguiraye',
 'sabang',
 'vardo',
 'provideniya',
 'puerto escondido',
 'raga',
 'concepcion',
 'ancud',
 'moranbah',
 'ust-ilimsk',
 'pangnirtung',
 'sterling',
 'waipawa',
 'souillac',
 'nazas',
 'ebano',
 'constitucion',
 'borogontsy',
 'azul',
 'geraldton',
 'rapid valley',
 'sorland',
 'artyk',
 'grindavik',
 'airai',
 'biak',
 'tuy hoa',
 'saleaula',
 'sao filipe',
 'saint-philippe',
 'fairbanks',
 'basoko',
 'pichayevo',
 'asau',
 'urozhayne',
 'yulara',
 'lashio',
 'cherskiy',
 'isla vista',
 'estepona',
 'new norfolk',
 'ouango',
 'kavieng',
 'castro',
 'totness',
 'sao sebastiao',
 'paragominas',
 'faanui',
 'bulolo',
 'palmares do sul',
 'manzhouli',
 'hibbing',
 'narsaq',
 'riyadh',
 'half moon bay',
 'east london',
 'ludvika',
 'iquique',
 'sao joao da barra',
 'kalabo',
 'umm lajj',
 'ano kastritsion',
 'richards bay',
 'tasbuget',
 'belushya guba',
 'sept-iles',
 'kaitong',
 'iqaluit',
 'iwanai',
 'lebork',
 'tomari',
 'broome',
 'kurilsk',
 'pacific grove',
 'leh',
 'maputo',
 'cockburn town',
 'toppenish',
 'zeya',
 'lufilufi',
 'aklavik',
 'manta',
 'louisbourg',
 'rungata',
 'fortuna',
 'kavaratti',
 'leningradskiy',
 'santa vitoria do palmar',
 'maarianhamina',
 'qaqortoq',
 'melbu',
 'georgetown',
 'fare',
 'puyang',
 'hambantota',
 'saint anthony',
 'ruatoria',
 'birjand',
 'tilichiki',
 'berlevag',
 'guymon',
 'luderitz',
 'sakakah',
 'santa fe',
 'ballina',
 'tautira',
 'okhotsk',
 'wa',
 'micheweni',
 'tlahuapan',
 'cidreira',
 'vetluzhskiy',
 'grand river south east',
 'olga',
 'chapais',
 'isla mujeres',
 'aranos',
 'tawkar',
 'saint george',
 'olean',
 'tulsipur',
 'lerwick',
 'severo-kurilsk',
 'la llave',
 'amberley',
 'galle',
 'ewa beach',
 'mount isa',
 'wajid',
 'sabzevar',
 'namibe',
 'alofi',
 'kaitangata',
 'beringovskiy',
 'benghazi',
 'bakel',
 'wanning',
 'leibnitz',
 'saint-francois',
 'touros',
 'koslan',
 'lira',
 'rio gallegos',
 'salina cruz',
 'alihe',
 'palabuhanratu',
 'tarakan',
 'churapcha',
 'matadi',
 'ixtapa',
 'teramo',
 'lucapa',
 'son la',
 'bonfim',
 'warqla',
 'great bend',
 'nadym',
 'knysna',
 'sinnamary',
 'poum',
 'labuan',
 'shimoda',
 'umzimvubu',
 'porto seguro',
 'toliary',
 'pryozerne',
 'vostok',
 'mandalgovi',
 'bandar-e lengeh',
 'dasoguz',
 'vila franca do campo',
 'lokhvytsya',
 'cabo san lucas',
 'mahajanga',
 'ambovombe',
 'sioux lookout',
 'vila do maio',
 'bethel',
 'bousso',
 'port keats',
 'dickinson',
 'mackay',
 'puerto leguizamo',
 'nizhneyansk',
 'tagusao',
 'muyezerskiy',
 'kampot',
 'saskylakh',
 'vestmannaeyjar',
 'pescantina',
 'cervo',
 'vanino',
 'pevek',
 'iberia',
 'muroto',
 'bara',
 'nelson bay',
 'manakara',
 'mattru',
 'samarai',
 'mezen',
 'bam',
 'zhuhai',
 'vaitape',
 'malwan',
 'nouadhibou',
 'paamiut',
 'tezu',
 'khandyga',
 'caravelas',
 'diego de almagro',
 'casa nova',
 'lompoc',
 'oros',
 'jaumave',
 'henties bay',
 'sibolga',
 'fomboni',
 'tabiauea',
 'veraval',
 'tailai',
 'ambatondrazaka',
 'roebourne',
 'newport',
 'sumenep',
 'vuktyl',
 'noshiro',
 'korla',
 'ratnagiri',
 'hearst',
 'marv dasht',
 'hami',
 'verkhnevilyuysk',
 'acapulco',
 'roald',
 'uelzen',
 'aksarka',
 'bama',
 'weinfelden',
 'alamogordo',
 'dhadar',
 'yumen',
 'makakilo city',
 'sandwick',
 'zhanatas',
 'gua musang',
 'banda aceh',
 'sunnyside',
 'santa rosa',
 'providencia',
 'vytegra',
 'helena',
 'viedma',
 'la rioja',
 'tonj',
 'sorvag',
 'kaa-khem',
 'axim',
 'tomball',
 'lafiagi',
 'salto',
 'olinda',
 'kununurra',
 'punta alta',
 'murud',
 'fevralsk',
 'ishigaki',
 'angol',
 'kyabe',
 'matamoros',
 'balestrand',
 'san antonio',
 'bafq',
 'takanosu',
 'dzilam gonzalez',
 'klaksvik',
 'kampong chhnang',
 'te anau',
 'itarema',
 'chabahar',
 'port-cartier',
 'ust-maya',
 'havre-saint-pierre',
 'hamilton',
 'honiara',
 'tsihombe',
 'kerki',
 'asayita',
 'cairns',
 'labutta',
 'kitimat',
 'gayny',
 'azad shahr',
 'nanortalik',
 'yar-sale',
 'pervomayskiy',
 'barcelona',
 'champerico',
 'belgrade',
 'safranbolu',
 'ordynskoye',
 'radishchevo',
 'cap malheureux',
 'gazli',
 'calama',
 'kilindoni',
 'kovdor',
 'tanete',
 'evensk',
 'owando',
 'fray bentos',
 'vila',
 'tuatapere',
 'san carlos',
 'thanh hoa',
 'southbridge',
 'mokrousovo',
 'broken hill',
 'egvekinot',
 'khonuu',
 'port hedland',
 'shingu',
 'san borja',
 'sawakin',
 'kloulklubed',
 'mabaruma',
 'voh',
 'macon',
 'rapid city',
 'foxton',
 'chumikan',
 'ust-kamchatsk',
 'la ronge',
 'kachug',
 'dien bien',
 'grand gaube',
 'caxito',
 'shakawe',
 'tommot',
 'oranjemund',
 'brive-la-gaillarde',
 'nuwara eliya',
 'narasannapeta',
 'burica',
 'mana',
 'snezhnogorsk',
 'cabedelo',
 'santa marta',
 'pokhara',
 'ljungby',
 'oriximina',
 'nemuro',
 'ous',
 'pisco',
 'mastic beach',
 'kanakapura',
 'tumannyy',
 'cruzeiro do sul',
 'lhokseumawe',
 'tiznit',
 'redlands',
 'buraydah',
 'flinders',
 'copiapo',
 'kijang',
 'manaure',
 'carutapera',
 'dali',
 'armacao dos buzios',
 'ivanteyevka',
 'rocha',
 'zhaotong',
 'taga',
 'zmeinogorsk',
 'maloshuyka',
 'havelock',
 'pitimbu',
 'kedrovyy',
 'guerrero negro',
 'tabou',
 'petauke',
 'alvorada',
 'yomitan',
 'sumbawa',
 'matara',
 'selizharovo',
 'skalistyy',
 'sao miguel',
 'balashov',
 'gilbues',
 'sangar',
 'manicaragua',
 'gorontalo',
 'lavrentiya',
 'morrope',
 'benguela',
 'texarkana',
 'zhigansk',
 'bitung',
 'aflu',
 'iwade',
 'savannah bight',
 'tlaxiaco',
 'kameoka',
 'gizo',
 'ketchikan',
 'hualmay',
 'edea',
 'kaeo',
 'lander',
 'portland',
 'baykit',
 'presidente epitacio',
 'sibu',
 'tocache',
 'aksarayskiy',
 'srednekolymsk',
 'garissa',
 'lastoursville',
 'avera',
 'winnetka',
 'brewster']


# In[ ]:


city_results = []


# In[ ]:


or city_name in cities:
    time.sleep(2)
    base_url = "http://api.openweathermap.org/data/2.5/weather?"
    complete_url = base_url + "appid=" + api_key + "&q=" + city_name 
    response = [requests.get(complete_url).json()]
    city_results = city_results + response


# In[ ]:


city_results[0]


# In[ ]:


{'coord': {'lon': -51.1, 'lat': 69.22},
 'weather': [{'id': 803,
   'main': 'Clouds',
   'description': 'broken clouds',
   'icon': '04d'}],
 'base': 'stations',
 'main': {'temp': 280.15,
  'pressure': 1003,
  'humidity': 48,
  'temp_min': 280.15,
  'temp_max': 280.15},
 'visibility': 10000,
 'wind': {'speed': 5.47, 'deg': 29.877},
 'clouds': {'all': 75},
 'dt': 1567290309,
 'sys': {'type': 1,
  'id': 165,
  'message': 0.0065,
  'country': 'GL',
  'sunrise': 1567237172,
  'sunset': 1567293032},
 'timezone': -7200,
 'id': 3423146,
 'name': 'Ilulissat',
 'cod': 200}

